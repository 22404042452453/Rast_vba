# Скрипты для программы Rastr

Набор скриптов на VBScript для проведения вариантных расчётов в программе Rastr (анализ электрических сетей).

## Описание

Проект содержит скрипты для автоматизации расчётов режимов работы электрических сетей при различных вариантах отключений и ремонтов оборудования. Результаты расчётов экспортируются в Excel для удобного анализа.

## Скрипты

### иварианты_v2.rbs
Скрипт для расчёта комбинаций ремонтов и аварийных отключений.

- Выполняет расчёты для различных комбинаций ремонтов (MaxRepair) и отключений (MaxOutage)
- Генерирует отчёт в Excel с 5 листами: напряжения в узлах, токи по линиям, токи по трансформаторам, мощность по линиям, мощность по трансформаторам
- Подсвечивает нарушения допустимых значений

### АОПН.rbs
Скрипт для расчёта односторонних отключений и аварийных отключений.

- Аналогичен предыдущему скрипту, но включает расчёты односторонних отключений линий (от начала или конца)
- Дополнительно выводит напряжения на концах линий

## Требования

- Программа Rastr (версия для Windows)
- Microsoft Excel
- VBScript runtime (входит в состав Windows)

## Подготовка данных

1. Откройте файл схемы в программе Rastr
2. Запустите скрипт PrepareTemplate (автоматически добавляет необходимые поля в таблицы)
3. Отметьте в поле "Report" ветви, для которых нужен отчёт
4. Отметьте в полях "Repair"/"Outage" (для иварианты_v2.rbs) или "S"/"Outage" (для АОПН.rbs) ветви для вариантных отключений

## Запуск расчётов

1. Откройте файл схемы в Rastr
2. Выполните скрипт (иварианты_v2.rbs или АОПН.rbs)
3. Дождитесь завершения расчётов
4. Результаты автоматически откроются в Excel

## Параметры настройки

В начале каждого скрипта можно настроить:
- MaxRepair / MaxS - максимальное количество одновременно ремонтируемых/отключаемых элементов
- MaxRepair_count / MaxS_count - минимальное количество элементов
- MaxOutage - максимальное количество аварийных отключений
- MaxOutage_count - минимальное количество аварийных отключений

## Структура отчёта Excel

### Лист "Напряжение в узлах"
- U, кВ - напряжение в узле
- U/Uном, % - процент от номинального напряжения
- Umin, кВ - минимально допустимое напряжение
- Umax, кВ - максимально допустимое напряжение

### Лист "Токи по линиям" / "Токи по трансформаторам"
- Iдоп, А - допустимый ток
- I, А - расчётный ток
- Iзагр, % - загрузка в процентах (подсвечивается при >100%)
- Vнач, кВ / Vкон, кВ - напряжения на концах (только для линий в АОПН.rbs)

### Лист "Мощность по линиям" / "Мощность по трансформаторам"
- S(нач)/S(кон), МВА - полная мощность
- P(нач)/P(кон), МВт - активная мощность
- Q(нач)/Q(кон), Мвар - реактивная мощность

## Примечания

- Скрипты используют комбинаторный подход для генерации всех возможных вариантов отключений
- Расчёты выполняются методом rgm("p") - установившийся режим
- Режимы, которые не сходятся, помечаются как "[Режим не существует]"
- Нарушения допустимых значений подсвечиваются красным цветом

## Автор

Проект разработан для автоматизации расчётов в программе Rastr при анализе надёжности электроснабжения.
